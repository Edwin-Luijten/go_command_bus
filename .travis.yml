sudo: false
language: go

env:
  - GO111MODULE=on

go:
  - 1.11.x
  - 1.12.x
  - master

git:
  depth: 1

install:
  - go get -v github.com/codeclimate/test-reporter
  - cd $GOPATH/src/github.com/codeclimate/test-reporter && git checkout tags/v1.0.1 && go install

before_script:
  - test-reporter before-build

script:
  - go test -coverprofile c.out -race

after_script:
  - test-reporter after-build --coverage-input-type gocov --exit-code $TRAVIS_TEST_RESULT